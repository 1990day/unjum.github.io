<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìš´ì  - í‰ìƒ ìš´ì„¸ ì •ë°€ ë¶„ì„</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;700&family=Noto+Serif+KR:wght@700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lunar-javascript/1.6.12/lunar.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
            color: #e0e0e0;
            line-height: 1.8; overflow-x: hidden; font-size: 16px;
        }

        h1, h2, h3, .logo, .category-title, .section-title, .page-title, .info-label, .graph-label {
            font-family: 'Noto Serif KR', serif;
        }

        /* --- [ìˆ˜ì •] í—¤ë” ìŠ¤íƒ€ì¼ --- */
        header {
            position: fixed; top: 0; left: 0; width: 100%; height: 75px;
            background-color: rgba(15, 32, 39, 0.98);
            display: flex !important; justify-content: space-between !important;
            align-items: center !important; padding: 0 40px; z-index: 1000 !important;
            border-bottom: 2px solid #cd7f32;
            box-shadow: 0 4px 20px rgba(0,0,0,0.5);
        }

        /* ë¡œê³  ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼ ë³µêµ¬ */
        .logo img { height: 40px; width: auto; }
        
        /* [PCìš©] ìƒë‹¨ ë©”ë‰´ */
        .top-menu { 
            display: flex !important; gap: 30px !important; list-style: none !important; margin-left: auto;
        }
        .top-menu a { 
            color: #d1d1d1 !important; text-decoration: none !important; 
            font-size: 1.1rem !important; font-weight: bold !important; cursor: pointer !important; display: block !important;
        }
        .top-menu a:hover { color: #cd7f32 !important; }

        /* [ëª¨ë°”ì¼ìš©] í–„ë²„ê±° ë²„íŠ¼ (PC ìˆ¨ê¹€) */
        .hamburger-btn {
            display: none; flex-direction: column; justify-content: space-between;
            width: 30px; height: 21px; cursor: pointer; z-index: 1100;
        }
        .hamburger-btn span {
            display: block; width: 100%; height: 3px;
            background-color: #cd7f32; /* í…Œë§ˆ ì»¬ëŸ¬ ì ìš© */
            border-radius: 3px; transition: all 0.3s ease;
        }
        .hamburger-btn.active span:nth-child(1) { transform: translateY(9px) rotate(45deg); }
        .hamburger-btn.active span:nth-child(2) { opacity: 0; }
        .hamburger-btn.active span:nth-child(3) { transform: translateY(-9px) rotate(-45deg); }

        /* [ìˆ˜ì •] ì‚¬ì´ë“œë°” ìŠ¤íƒ€ì¼ */
        .sidebar {
            position: fixed; top: 75px; left: 0; width: 260px;
            height: calc(100vh - 75px); background-color: #14282f;
            padding: 25px; overflow-y: auto; border-right: 1px solid #2c3e50; z-index: 100;
            transition: left 0.3s ease-in-out; /* ìŠ¬ë¼ì´ë“œ íš¨ê³¼ ì¶”ê°€ */
        }
        .menu-category { margin-bottom: 35px; }
        .category-title { font-size: 1.3rem; color: #cd7f32; margin-bottom: 15px; display: block; border-bottom: 1px solid #444; padding-bottom: 8px; font-weight: bold; }
        .sub-menu { list-style: none; padding-left: 10px; }
        .sub-menu a { color: #aab7b8; text-decoration: none; font-size: 1rem; display: block; margin-bottom: 12px; cursor: pointer; transition: all 0.3s; }
        .sub-menu a:hover { color: #fff; transform: translateX(5px); color: #cd7f32; }

        /* [ì¶”ê°€] ëª¨ë°”ì¼ìš© ì˜¤ë²„ë ˆì´ */
        .overlay {
            display: none; position: fixed; top: 75px; left: 0;
            width: 100%; height: calc(100vh - 75px);
            background-color: rgba(0, 0, 0, 0.7); z-index: 90; opacity: 0; transition: opacity 0.3s ease;
        }
        .overlay.active { display: block; opacity: 1; }

        /* ë©”ì¸ ì˜ì—­ */
        main { margin-top: 80px; margin-left: 260px; padding: 40px 20px; display: flex; justify-content: center; transition: margin-left 0.3s ease; }
        .fortune-page { width: 100%; max-width: 950px; }
        .page-title { font-size: 2.2rem; color: #cd7f32; margin-bottom: 40px; text-align: center; font-weight: bold; text-shadow: 0 0 15px rgba(205, 127, 50, 0.2); }

        .input-card {
            background: #1c333a; padding: 40px; border-radius: 20px;
            border: 1px solid #cd7f32; margin-bottom: 50px;
            box-shadow: 0 15px 30px rgba(0,0,0,0.3);
        }
        .input-row { margin-bottom: 25px; }
        .input-row label { display: block; margin-bottom: 10px; color: #cd7f32; font-weight: bold; font-size: 1.1rem; }
        .select-group { display: flex; gap: 10px; }
        select, input[type="text"] { 
            flex: 1; padding: 12px; background: #264047; border: 1px solid #4a636a; 
            color: #fff; border-radius: 8px; font-family: 'Noto Sans KR', sans-serif !important; font-size: 1rem; 
        }
        
        .gender-toggle, .type-toggle { display: flex; gap: 10px; margin-top: 10px; }
        .gender-btn, .type-btn { 
            flex: 1; padding: 12px; background: #264047; border: 1px solid #4a636a; 
            color: #aab7b8; border-radius: 8px; cursor: pointer; text-align: center; font-weight: bold; 
        }
        .gender-btn.active, .type-btn.active { background: #cd7f32; color: #1a1a2e; border-color: #cd7f32; }

        .submit-btn { 
            width: 100%; padding: 18px; 
            background: linear-gradient(45deg, #cd7f32, #f4a460); 
            color: #0f2027; border: none; border-radius: 12px; font-size: 1.3rem; font-weight: bold; cursor: pointer; margin-top: 30px; 
            box-shadow: 0 5px 15px rgba(205, 127, 50, 0.3);
        }

        #result-area { margin-top: 60px; display: none; }
        
        .info-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 50px; }
        .info-card {
            background: linear-gradient(145deg, #1c333a, #14282f);
            padding: 25px; border-radius: 20px; border: 2px solid #cd7f32;
            text-align: center; box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        }
        .info-label { font-size: 1.1rem; color: #cd7f32; display: block; margin-bottom: 10px; font-weight: bold; }
        .info-value { font-size: 1.4rem; font-weight: bold; color: #fff; border-bottom: 2px solid rgba(205, 127, 50, 0.3); padding-bottom: 5px;}

        .section-card { 
            background: #1c333a; padding: 35px; border-radius: 25px; margin-bottom: 35px; 
            box-shadow: 0 5px 20px rgba(0,0,0,0.2); border-left: 5px solid #cd7f32; 
        }
        .section-title { 
            font-size: 1.6rem; color: #f4a460; margin-bottom: 25px; 
            border-bottom: 1px solid #4a636a; padding-bottom: 10px; font-weight: bold; 
        }
        .section-content { 
            font-size: 1.1rem; color: #dcdcdc; text-align: justify; 
            white-space: pre-wrap; word-break: keep-all; line-height: 2.1; 
        }

        .life-graph-card { background: #1c333a; padding: 40px; border-radius: 25px; border: 1px solid #4a636a; margin-top: 50px; }
        .chart-container { 
            display: flex; align-items: flex-end; justify-content: space-between; 
            height: 300px; margin: 50px 0; border-bottom: 2px solid #555; padding: 0 5px; 
        }
        .bar-wrapper { 
            flex: 1; display: flex; flex-direction: column; align-items: center; 
            position: relative; height: 100%; justify-content: flex-end; 
        }
        .bar { 
            width: 40%; border-radius: 6px 6px 0 0; transition: height 1s; 
            background: linear-gradient(to top, #cd7f32, #f4a460); 
            box-shadow: 0 0 8px rgba(205, 127, 50, 0.4);
        }
        .score-val { font-size: 0.8rem; font-weight: bold; margin-bottom: 8px; color: #f4a460; }
        .graph-label { margin-top: 15px; font-size: 0.9rem; font-weight: bold; color: #ccc; }

        /* --- [ìˆ˜ì •] ë°˜ì‘í˜• (768px ì´í•˜) --- */
        @media (max-width: 768px) {
            header { padding: 0 20px; height: 60px; }
            .logo img { height: 28px; } /* ëª¨ë°”ì¼ì—ì„œ ë¡œê³  í¬ê¸° ì¡°ì • */
            
            /* ë©”ë‰´ ì œì–´ */
            .top-menu { display: none !important; }
            .hamburger-btn { display: flex; }

            /* ì‚¬ì´ë“œë°” ì œì–´ */
            .sidebar { left: -270px; top: 60px; height: calc(100vh - 60px); }
            .sidebar.open { left: 0; }
            .overlay { top: 60px; height: calc(100vh - 60px); }

            /* ë©”ì¸ ì˜ì—­ ì œì–´ */
            main { margin-left: 0; margin-top: 60px; padding: 30px 15px; }
            
            .info-grid { grid-template-columns: 1fr; }
            .section-card { padding: 25px; }
            .input-card { padding: 25px; }
        }
    </style>
</head>
<body>
    <header>
        <a href="index.html" class="logo"><img src="img_logo1.png" alt="logo"></a>
        
        <nav class="top-menu">
            <a href="today_fortune.html">ìš´ì„¸</a>
            <a href="manse_calendar.html">ì‚¬ì£¼</a>
            <a href="love-fortune.html">ì—°ì• </a>
            <a href="charm-score.html">ë„íŒŒë¯¼</a>
            <a href="weekly-zodiac.html">ë³„ìë¦¬</a>
        </nav>

        <div class="hamburger-btn" onclick="toggleSidebar()">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </header>

    <div class="overlay" onclick="toggleSidebar()"></div>

    <aside class="sidebar" id="sidebar">
        <div class="menu-category">
            <span class="category-title">ìš´ì„¸</span>
            <ul class="sub-menu">
                <li><a href="today_fortune.html">ì˜¤ëŠ˜ì˜ ìš´ì„¸</a></li>
                <li><a href="new_year_fortune.html">ì‹ ë…„ ìš´ì„¸</a></li>
                <li><a href="lifetime_fortune.html">í‰ìƒ ìš´ì„¸</a></li>
            </ul>
        </div>
        <div class="menu-category">
            <span class="category-title">ì‚¬ì£¼</span>
            <ul class="sub-menu">
                <li><a href="manse_calendar.html">ì •í†µ ë§Œì„¸ë ¥</a></li>
                <li><a href="traditional_saju.html">ì •í†µ ì‚¬ì£¼</a></li>
                <li><a href="my_saju.html">ë‚´ ì‚¬ì£¼ í’€ì´</a></li>
            </ul>
        </div>
        <div class="menu-category">
            <span class="category-title">ì—°ì• </span>
            <ul class="sub-menu">
                <li><a href="love-fortune.html">í‰ìƒ ì—°ì• ìš´</a></li>
                <li><a href="saju-compatibility.html">ì‚¬ì£¼ ê¶í•©</a></li>
                <li><a href="reunion-saju.html">ì¬íšŒ ì‚¬ì£¼</a></li>
            </ul>
        </div>
        <div class="menu-category">
            <span class="category-title">ë„íŒŒë¯¼</span>
            <ul class="sub-menu">
                <li><a href="charm-score.html">ë‚´ ì‚¬ì£¼ì˜ ë§¤ë ¥ë„</a></li>
                <li><a href="saju-popularity.html">ì‚¬ì£¼ì— ìˆëŠ” ì¸ê¸°ìš´</a></li>
                <li><a href="dohwasal-check.html">ë„í™”ì‚´ ì§„ë‹¨ê¸°</a></li>
                <li><a href="saju-spotlight.html">ì£¼ëª©ë°›ëŠ” ì‚¬ì£¼</a></li>
            </ul>
        </div>
        <div class="menu-category">
            <span class="category-title">ë³„ìë¦¬</span>
            <ul class="sub-menu">
                <li><a href="weekly-zodiac.html">ì´ë²ˆì£¼ ë³„ìë¦¬ ìš´ì„¸</a></li>
                <li><a href="monthly-zodiac.html">ì´ë²ˆë‹¬ ë³„ìë¦¬ ìš´ì„¸</a></li>
            </ul>
        </div>
    </aside>

    <main>
        <div class="fortune-page">
            <h2 class="page-title">í‰ìƒ ìš´ì„¸ ëŒ€ìš´(å¤§é‹) ë¶„ì„</h2>
            <div class="input-card">
                <div class="input-row"><label>ì„±í•¨</label><input type="text" id="userName" placeholder="ì´ë¦„ ì…ë ¥"></div>
                <div class="input-row"><label>ì„±ë³„ (ëŒ€ìš´ ê³„ì‚° í•„ìˆ˜)</label>
                    <div class="gender-toggle">
                        <div class="gender-btn active" onclick="setGender(this, '1')">ë‚¨ì„±</div>
                        <div class="gender-btn" onclick="setGender(this, '0')">ì—¬ì„±</div>
                    </div>
                </div>
                <div class="input-row"><label>ìƒë…„ì›”ì¼</label>
                    <div class="select-group"><select id="yearSelect"></select><select id="monthSelect"></select><select id="daySelect"></select></div>
                    <div class="type-toggle">
                        <div id="solarBtn" class="type-btn active" onclick="setCalendar('solar')">ì–‘ë ¥</div>
                        <div id="lunarBtn" class="type-btn" onclick="setCalendar('lunar')">ìŒë ¥</div>
                    </div>
                </div>
                <div class="input-row"><label>íƒœì–´ë‚œ ì‹œê°„</label>
                    <select id="hourSelect">
                        <option value="-1">ëª¨ë¦„</option>
                        <option value="0">ìì‹œ (23:30 ~ 01:29)</option><option value="2">ì¶•ì‹œ (01:30 ~ 03:29)</option>
                        <option value="4">ì¸ì‹œ (03:30 ~ 05:29)</option><option value="6">ë¬˜ì‹œ (05:30 ~ 07:29)</option>
                        <option value="8">ì§„ì‹œ (07:30 ~ 09:29)</option><option value="10">ì‚¬ì‹œ (09:30 ~ 11:29)</option>
                        <option value="12">ì˜¤ì‹œ (11:30 ~ 13:29)</option><option value="14">ë¯¸ì‹œ (13:30 ~ 15:29)</option>
                        <option value="16">ì‹ ì‹œ (15:30 ~ 17:29)</option><option value="18">ìœ ì‹œ (17:30 ~ 19:29)</option>
                        <option value="20">ìˆ ì‹œ (19:30 ~ 21:29)</option><option value="22">í•´ì‹œ (21:30 ~ 23:29)</option>
                    </select>
                </div>
                <button class="submit-btn" onclick="analyzeLifeFortune()">ë‚˜ì˜ í‰ìƒ ëŒ€ìš´ í™•ì¸í•˜ê¸°</button>
            </div>

            <div id="result-area">
                <div class="info-grid" id="summaryArea"></div>
                <div class="section-card"><h3 class="section-title">ğŸ“œ í‰ìƒ ì´ìš´ ë° ì‚¬ì£¼ ì›êµ­ ë¶„ì„</h3><p class="section-content" id="resTotal"></p></div>
                <div class="section-card"><h3 class="section-title">ğŸŒ± ì´ˆë…„ê¸° ìš´ì„¸ (ì„±ì¥ê³¼ í•™ì—…)</h3><p class="section-content" id="resEarly"></p></div>
                <div class="section-card"><h3 class="section-title">ğŸ”¥ ì¤‘ë…„ê¸° ìš´ì„¸ (ì¬ë¬¼ê³¼ ì‚¬íšŒ)</h3><p class="section-content" id="resMiddle"></p></div>
                <div class="section-card"><h3 class="section-title">ğŸŒ² ë…¸ë…„ê¸° ìš´ì„¸ (ê±´ê°•ê³¼ ì•ˆë½)</h3><p class="section-content" id="resLate"></p></div>
                <div class="life-graph-card">
                    <h3 class="section-title">ğŸ“ˆ ì¸ìƒ ëŒ€ìš´(10ë…„ ì£¼ê¸°) íë¦„ë„</h3>
                    <div class="chart-container" id="chartArea"></div>
                </div>
            </div>
        </div>
    </main>

    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.querySelector('.overlay');
            const hamburger = document.querySelector('.hamburger-btn');

            sidebar.classList.toggle('open');
            overlay.classList.toggle('active');
            hamburger.classList.toggle('active');
        }

        const ys=document.getElementById('yearSelect'), ms=document.getElementById('monthSelect'), ds=document.getElementById('daySelect');
        for(let i=2026;i>=1940;i--){let o=document.createElement('option');o.value=i;o.text=i+'ë…„';ys.add(o);}
        for(let i=1;i<=12;i++){let o=document.createElement('option');o.value=i;o.text=i+'ì›”';ms.add(o);}
        for(let i=1;i<=31;i++){let o=document.createElement('option');o.value=i;o.text=i+'ì¼';ds.add(o);}

        let genderVal = '1'; 
        let calType = 'solar';

        function setGender(el, val) {
            document.querySelectorAll('.gender-btn').forEach(b => b.classList.remove('active'));
            el.classList.add('active');
            genderVal = val;
        }

        function setCalendar(type) {
            calType = type;
            document.getElementById('solarBtn').className = type === 'solar' ? 'type-btn active' : 'type-btn';
            document.getElementById('lunarBtn').className = type === 'lunar' ? 'type-btn active' : 'type-btn';
        }

        function analyzeLifeFortune() {
            const name = document.getElementById('userName').value; if (!name) return alert("ì„±í•¨ì„ ì…ë ¥í•˜ì„¸ìš”.");
            const y = parseInt(ys.value), m = parseInt(ms.value), d = parseInt(ds.value), h = parseInt(document.getElementById('hourSelect').value);
            
            // 1. ë§Œì„¸ë ¥ ê¸°ë³¸ ê³„ì‚°
            let s;
            if (calType === 'solar') {
                s = Solar.fromYmdHms(y, m, d, h === -1 ? 12 : h, 0, 0);
            } else {
                s = Lunar.fromYmdHms(y, m, d, h === -1 ? 12 : h, 0, 0).getSolar();
            }

            const eight = s.getLunar().getEightChar();
            const myGan = eight.getDayGan(); 
            const yearGan = eight.getYearGan();
            const monthGan = eight.getMonthGan();
            const monthZhi = eight.getMonthZhi();

            // 2. ëŒ€ìš´ ì§ì ‘ ê³„ì‚° (ì•ˆì „ ë¡œì§)
            const ganArr = ["ç”²", "ä¹™", "ä¸™", "ä¸", "æˆŠ", "å·±", "åºš", "è¾›", "å£¬", "ç™¸"];
            const zhiArr = ["å­", "ä¸‘", "å¯…", "å¯", "è¾°", "å·³", "åˆ", "æœª", "ç”³", "é…‰", "æˆŒ", "äº¥"];
            
            const isYangYear = [0, 2, 4, 6, 8].includes(ganArr.indexOf(yearGan));
            const isMale = (genderVal === '1');
            const isForward = (isMale && isYangYear) || (!isMale && !isYangYear);
            
            let startGanIdx = ganArr.indexOf(monthGan);
            let startZhiIdx = zhiArr.indexOf(monthZhi);
            
            let manualDaewoon = [];
            for (let i = 1; i <= 8; i++) { 
                let step = isForward ? i : -i;
                let nextGanIdx = (startGanIdx + step) % 10;
                let nextZhiIdx = (startZhiIdx + step) % 12;
                if (nextGanIdx < 0) nextGanIdx += 10;
                if (nextZhiIdx < 0) nextZhiIdx += 12;
                manualDaewoon.push({gan: ganArr[nextGanIdx], zhi: zhiArr[nextZhiIdx], label: ganArr[nextGanIdx] + zhiArr[nextZhiIdx]});
            }

            // 3. ì˜¤í–‰ ë° ì ìˆ˜ ê³„ì‚°
            const ganToEle = {"ç”²":"æœ¨","ä¹™":"æœ¨","ä¸™":"ç«","ä¸":"ç«","æˆŠ":"åœŸ","å·±":"åœŸ","åºš":"é‡‘","è¾›":"é‡‘","å£¬":"æ°´","ç™¸":"æ°´"};
            const zhiToEle = {"å­":"æ°´","ä¸‘":"åœŸ","å¯…":"æœ¨","å¯":"æœ¨","è¾°":"åœŸ","å·³":"ç«","åˆ":"ç«","æœª":"åœŸ","ç”³":"é‡‘","é…‰":"é‡‘","æˆŒ":"åœŸ","äº¥":"æ°´"};
            const myEle = ganToEle[myGan];
            let eleCount = {"æœ¨":0, "ç«":0, "åœŸ":0, "é‡‘":0, "æ°´":0};
            
            [yearGan, monthGan, myGan, eight.getTimeGan()].forEach(g => { if(ganToEle[g]) eleCount[ganToEle[g]]++; });
            [eight.getYearZhi(), eight.getMonthZhi(), eight.getDayZhi(), eight.getTimeZhi()].forEach(z => { if(zhiToEle[z]) eleCount[zhiToEle[z]]++; });
            
            const totalScore = 70 + (eleCount[ganToEle[myGan]] * 5); 

            // **í•µì‹¬: ë¶€ì¡±í•œ ì˜¤í–‰(ìš©ì‹ )ê³¼ ì‹ ê°•/ì‹ ì•½ íŒë³„**
            const sortedEle = Object.entries(eleCount).sort((a,b) => a[1] - b[1]);
            const lackEle = sortedEle[0][0]; // ê°€ì¥ ë¶€ì¡±í•œ ì˜¤í–‰ (ìš©ì‹  í›„ë³´)
            
            // ì‹ ê°•/ì‹ ì•½ (ë‚˜ë¥¼ ë•ëŠ” ì¸ì„±/ë¹„ê² ê°œìˆ˜)
            const cycles = ["æœ¨", "ç«", "åœŸ", "é‡‘", "æ°´"];
            let myIdx = cycles.indexOf(myEle);
            // ì¸ì„±(ë‚˜ë¥¼ ìƒí•¨) + ë¹„ê²(ë‚˜ì™€ ê°™ìŒ)ì˜ í•©
            let supportCnt = eleCount[myEle] + eleCount[cycles[(myIdx + 4) % 5]];
            const isStrong = supportCnt >= 4; // 4ê°œ ì´ìƒì´ë©´ ì‹ ê°•

            // 4. ì‹­ì„± ë¡œì§
            const getTenGods = (targetEle) => {
                if (myEle === targetEle) return "ë¹„ê²";
                let targetIdx = cycles.indexOf(targetEle);
                if ((myIdx + 1) % 5 === targetIdx) return "ì‹ìƒ"; 
                if ((myIdx + 2) % 5 === targetIdx) return "ì¬ì„±"; 
                if ((targetIdx + 1) % 5 === myIdx) return "ì¸ì„±"; 
                if ((targetIdx + 2) % 5 === myIdx) return "ê´€ì„±"; 
                return "ë¹„ê²";
            };

            // 5. í…ìŠ¤íŠ¸ ìƒì„± ì—”ì§„ (ê³ ì • ë©˜íŠ¸ 0%, 100% ë¡œì§ ê¸°ë°˜)
            const buildDynamicText = (period) => {
                let lines = [];
                let dwData = null; 
                
                // ì‹œê¸°ë³„ ëŒ€ìš´ ë§¤í•‘
                if (period === 'early') dwData = manualDaewoon[0];
                else if (period === 'middle') dwData = manualDaewoon[3];
                else if (period === 'late') dwData = manualDaewoon[6];

                let tenGod = "";
                let daewoonGan = "";
                let dwEle = "";
                
                if (dwData) {
                    daewoonGan = dwData.gan;
                    dwEle = ganToEle[daewoonGan];
                    tenGod = getTenGods(dwEle);
                }

                // **[Total ì„¹ì…˜] ì™„ì „ ë™ì  ë¡œì§**
                if (period === 'total') {
                    // 1. ì¼ê°„ ë¶„ì„
                    lines.push(`${name}ë‹˜ì˜ í‰ìƒ ì‚¬ì£¼ëŠ” '${myGan}'(${myEle}) ì¼ê°„ì„ ì¤‘ì‹¬ìœ¼ë¡œ í˜•ì„±ë˜ì–´ ìˆìœ¼ë©°, ì‚¬ì£¼ ì „ì²´ì—ì„œ ê°€ì¥ ì˜í–¥ë ¥ì´ í° ê¸°ìš´ì€ '${Object.keys(eleCount).reduce((a, b) => eleCount[a] > eleCount[b] ? a : b)}'ì…ë‹ˆë‹¤.`);
                    
                    // 2. ì‹ ê°•/ì‹ ì•½ ì²˜ì„¸ìˆ 
                    if(isStrong) {
                        lines.push(`ê·€í•˜ëŠ” ë³¸ì¸ì˜ ê¸°ìš´ì´ ê°•í•œ 'ì‹ ê°•(èº«å¼º)' ì‚¬ì£¼ë¡œ, ì£¼ê´€ì´ ëšœë ·í•˜ê³  ì¶”ì§„ë ¥ì´ ê°•í•©ë‹ˆë‹¤. ìš´ì—ì„œ í˜ì„ ë¹¼ì£¼ëŠ” ì‹ìƒì´ë‚˜ ì¬ì„± ìš´ì´ ì˜¬ ë•Œ ë°œë³µí•©ë‹ˆë‹¤.`);
                        lines.push(`ë‚¨ì˜ ë„ì›€ì„ ë°›ê¸°ë³´ë‹¤ ë³¸ì¸ì˜ ëŠ¥ë ¥ìœ¼ë¡œ ì„±ì·¨í•˜ëŠ” ììˆ˜ì„±ê°€í˜•ì´ë©°, ê³ ì§‘ì„ êº¾ê³  íƒ€í˜‘í•˜ëŠ” ìœ ì—°í•¨ì´ ì„±ê³µì˜ ì—´ì‡ ì…ë‹ˆë‹¤.`);
                    } else {
                        lines.push(`ê·€í•˜ëŠ” ë³¸ì¸ì˜ ê¸°ìš´ì´ ë¶€ë“œëŸ¬ìš´ 'ì‹ ì•½(èº«å¼±)' ì‚¬ì£¼ë¡œ, í™˜ê²½ì— ì ì‘í•˜ëŠ” ëŠ¥ë ¥ì´ ë›°ì–´ë‚˜ê³  ì„¬ì„¸í•©ë‹ˆë‹¤. ìš´ì—ì„œ ë‚˜ë¥¼ ë•ëŠ” ì¸ì„±ì´ë‚˜ ë¹„ê² ìš´ì´ ì˜¬ ë•Œ ë°œë³µí•©ë‹ˆë‹¤.`);
                        lines.push(`í˜¼ì ëª¨ë“  ê²ƒì„ ê°ë‹¹í•˜ê¸°ë³´ë‹¤ ì£¼ë³€ì˜ ë„ì›€ì„ ì ê·¹ì ìœ¼ë¡œ í™œìš©í•˜ê³ , ë©˜í† ë‚˜ í˜‘ë ¥ìì™€ í•¨ê»˜í•  ë•Œ ì‹œë„ˆì§€ê°€ ë‚©ë‹ˆë‹¤.`);
                    }

                    // 3. ìš©ì‹ (ë¶€ì¡±í•œ ì˜¤í–‰) ì¡°ì–¸
                    lines.push(`ê·€í•˜ì—ê²Œ ê°€ì¥ í•„ìš”í•œ ê¸°ìš´(ìš©ì‹ )ì€ '${lackEle}'ì…ë‹ˆë‹¤.`);
                    if(lackEle === 'æœ¨') lines.push(`ëª©(æœ¨) ê¸°ìš´ì´ ë¶€ì¡±í•˜ë¯€ë¡œ, ìƒˆë¡œìš´ ì‹œì‘, ê¸°íš, êµìœ¡, ì¸ìí•¨ê³¼ ê´€ë ¨ëœ í™œë™ì„ í•  ë•Œ ì‚¶ì´ ìœ¤íƒí•´ì§‘ë‹ˆë‹¤.`);
                    else if(lackEle === 'ç«') lines.push(`í™”(ç«) ê¸°ìš´ì´ ë¶€ì¡±í•˜ë¯€ë¡œ, ì—´ì •ì„ í‘œí˜„í•˜ê³ , ë°ê³  í™”ë ¤í•œ ê³³ì—ì„œ í™œë™í•˜ë©° ì˜ˆì˜ë¥¼ ê°–ì¶”ëŠ” ê²ƒì´ ê°œìš´ë²•ì…ë‹ˆë‹¤.`);
                    else if(lackEle === 'åœŸ') lines.push(`í† (åœŸ) ê¸°ìš´ì´ ë¶€ì¡±í•˜ë¯€ë¡œ, ë¯¿ìŒê³¼ ì‹ ìš©ì„ ì¤‘ì‹œí•˜ê³ , ë¶€ë™ì‚°ì´ë‚˜ ì¤‘ê°œ, ê¸°ë°˜ì„ ë‹¤ì§€ëŠ” ì¼ì— ì§‘ì¤‘í•´ì•¼ í•©ë‹ˆë‹¤.`);
                    else if(lackEle === 'é‡‘') lines.push(`ê¸ˆ(é‡‘) ê¸°ìš´ì´ ë¶€ì¡±í•˜ë¯€ë¡œ, ê²°ë‹¨ë ¥ì„ ê¸°ë¥´ê³  ë§ºê³  ëŠìŒì„ í™•ì‹¤íˆ í•˜ë©°, ì˜ë¦¬ë¥¼ ì§€í‚¤ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.`);
                    else if(lackEle === 'æ°´') lines.push(`ìˆ˜(æ°´) ê¸°ìš´ì´ ë¶€ì¡±í•˜ë¯€ë¡œ, ì§€í˜œì™€ ìœ ì—°í•œ ì‚¬ê³ ë¥¼ ê¸°ë¥´ê³ , í•´ì™¸ë‚˜ ìœ í†µ, íœ´ì‹ê³¼ ê´€ë ¨ëœ í™œë™ì´ ë„ì›€ì´ ë©ë‹ˆë‹¤.`);

                    // 4. ëŒ€ìš´ íë¦„ ë¶„ì„ (ì´ˆë…„ vs ë§ë…„ ë¹„êµ)
                    let firstEle = ganToEle[manualDaewoon[0].gan];
                    let lastEle = ganToEle[manualDaewoon[7].gan];
                    let firstGood = (firstEle === lackEle); // ì´ˆë…„ì´ ìš©ì‹ ìš´ì¸ê°€?
                    let lastGood = (lastEle === lackEle);   // ë§ë…„ì´ ìš©ì‹ ìš´ì¸ê°€?

                    if(firstGood && lastGood) lines.push(`í‰ìƒì— ê±¸ì³ ê·€í•œ ìš´ì´ íë¥´ëŠ” ë³µëœ êµ¬ì¡°ë¡œ, ì´ˆë…„ì˜ ì„±ê³µì„ ë§ë…„ê¹Œì§€ ì•ˆì •ì ìœ¼ë¡œ ì´ì–´ê°ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.`);
                    else if(firstGood && !lastGood) lines.push(`ì´ˆë…„ì— ìš´ì˜ íë¦„ì´ ì¢‹ì•„ ì¼ì° ë‘ê°ì„ ë‚˜íƒ€ë‚´ë‚˜, ë§ë…„ì—ëŠ” ìˆ˜ì„±(å®ˆæˆ)í•˜ëŠ” ìì„¸ë¡œ ì•ˆì •ì„ ì¶”êµ¬í•´ì•¼ í•©ë‹ˆë‹¤.`);
                    else if(!firstGood && lastGood) lines.push(`ì´ˆë…„ì—ëŠ” ë‹¤ì†Œ ì‹œë ¨ì´ ìˆì„ ìˆ˜ ìˆìœ¼ë‚˜, ì´ë¥¼ ê·¹ë³µí•˜ê³  ë§ë…„ì— í¬ê²Œ ê½ƒí”¼ìš°ëŠ” ì „í˜•ì ì¸ ëŒ€ê¸°ë§Œì„±í˜• ìš´ì„¸ì…ë‹ˆë‹¤.`);
                    else lines.push(`ìš´ì˜ êµ´ê³¡ì´ ìˆì–´ í‰íƒ„ì¹˜ ì•Šì„ ìˆ˜ ìˆìœ¼ë‚˜, ì´ëŠ” ê·€í•˜ë¥¼ ë‹¨ë ¨ì‹œí‚¤ëŠ” ê³¼ì •ì´ë©° ë³¸ì¸ì˜ ì˜ì§€ë¡œ ì¶©ë¶„íˆ ê°œì²™ ê°€ëŠ¥í•©ë‹ˆë‹¤.`);

                } else if (period === 'early') {
                    // [ì´ˆë…„ê¸°]
                    lines.push(`ì´ˆë…„ê¸°ì—ëŠ” '${daewoonGan}(${dwEle})', ì¦‰ ì‹­ì„±ìœ¼ë¡œ '${tenGod}'ì˜ ê¸°ìš´ì´ ì§€ë°°í•©ë‹ˆë‹¤.`);
                    if(tenGod === "ì¸ì„±") lines.push(`í•™ì—…ìš´ì´ ë“¤ì–´ì™€ ê³µë¶€ì— ì§‘ì¤‘í•˜ê¸° ì¢‹ê³ , ë¶€ëª¨ë‹˜ì´ë‚˜ ì„ ìƒë‹˜ì˜ ì‚¬ë‘ì„ ë°›ìœ¼ë©° ì„±ì¥í•˜ëŠ” ì‹œê¸°ì…ë‹ˆë‹¤.`);
                    else if(tenGod === "ì‹ìƒ") lines.push(`í˜¸ê¸°ì‹¬ì´ ë§ê³  í™œë™ì ì¸ ì—ë„ˆì§€ê°€ ë„˜ì³, ì±…ìƒ ì•ë³´ë‹¤ëŠ” ë‹¤ì–‘í•œ ê²½í—˜ê³¼ ì˜ˆì²´ëŠ¥ í™œë™ì—ì„œ ì¬ëŠ¥ì„ ë°œê²¬í•©ë‹ˆë‹¤.`);
                    else if(tenGod === "ì¬ì„±") lines.push(`í˜„ì‹¤ ê°ê°ì´ ë¹¨ë¦¬ íŠ¸ì—¬ í•™ì—…ë³´ë‹¤ëŠ” ì¹œêµ¬ë‚˜ ìš©ëˆ ë²Œì´, ì´ì„±ì— ì¼ì° ê´€ì‹¬ì„ ê°–ê²Œ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`);
                    else if(tenGod === "ê´€ì„±") lines.push(`ì±…ì„ê°ì´ ê°•í•˜ê³  ê·œì¹™ì„ ì˜ ì§€í‚¤ë©°, ë°˜ì¥ì´ë‚˜ ì„ì›ì„ ë§¡ëŠ” ë“± ë¦¬ë”ì‹­ì„ ë°œíœ˜í•  ê¸°íšŒê°€ ë§ìŠµë‹ˆë‹¤.`);
                    else lines.push(`ìì•„ê°€ ê°•í•´ì ¸ ë…ë¦½ì‹¬ì´ ìƒê¸°ê³  ì¹œêµ¬ë“¤ê³¼ì˜ ê²½ìŸì„ í†µí•´ ë³¸ì¸ì˜ ì¡´ì¬ê°ì„ í™•ì¸í•˜ë ¤ëŠ” ìš•êµ¬ê°€ í½ë‹ˆë‹¤.`);
                    
                    // ìš©ì‹  ì—¬ë¶€ì— ë”°ë¥¸ ì¡°ì–¸
                    if(dwEle === lackEle) lines.push(`íŠ¹íˆ ì´ ì‹œê¸°ëŠ” ë³¸ì¸ì—ê²Œ í•„ìš”í•œ ê¸°ìš´ì´ ë“¤ì–´ì˜¤ë¯€ë¡œ, ë…¸ë ¥í•œ ê²ƒë³´ë‹¤ ë” ì¢‹ì€ ì„±ê³¼(í•™ì—…, ì§„ë¡œ)ë¥¼ ì–»ê¸° ì‰½ìŠµë‹ˆë‹¤.`);
                    else lines.push(`ìš´ì˜ ì§€ì›ì´ ë‹¤ì†Œ ì•½í•  ìˆ˜ ìˆìœ¼ë‹ˆ, ìš”í–‰ì„ ë°”ë¼ê¸°ë³´ë‹¤ ì„±ì‹¤í•¨ìœ¼ë¡œ ê¸°ì´ˆë¥¼ ë‹¤ì§€ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.`);

                } else if (period === 'middle') {
                    // [ì¤‘ë…„ê¸°]
                    lines.push(`ì¤‘ë…„ê¸°(ì‚¬íšŒ í™œë™ê¸°)ì—ëŠ” '${tenGod}' ìš´ì´ ë“¤ì–´ì™€ ì‚¶ì˜ ë°©í–¥ì„ ê²°ì •í•©ë‹ˆë‹¤.`);
                    if(tenGod === "ì¬ì„±") lines.push(`ì¬ë¬¼ í™œë™ì´ ì™•ì„±í•´ì§€ëŠ” ì‹œê¸°ë¡œ, ì‚¬ì—…ì´ë‚˜ íˆ¬ìë¥¼ í†µí•´ ìì‚°ì„ ì¦ì‹í•˜ë ¤ëŠ” ìš•êµ¬ê°€ ê°•í•´ì§€ê³  ê¸°íšŒë„ ì°¾ì•„ì˜µë‹ˆë‹¤.`);
                    else if(tenGod === "ê´€ì„±") lines.push(`ì§ì¥ì—ì„œì˜ ìŠ¹ì§„ì´ë‚˜ ëª…ì˜ˆë¥¼ ì–»ëŠ” ìš´ìœ¼ë¡œ, ì¡°ì§ ë‚´ì—ì„œ ê¶Œí•œì´ ì»¤ì§€ê³  ì‚¬íšŒì  ì§€ìœ„ê°€ ìƒìŠ¹í•©ë‹ˆë‹¤.`);
                    else if(tenGod === "ì‹ìƒ") lines.push(`ë³¸ì¸ì˜ ëŠ¥ë ¥ì„ ë°–ìœ¼ë¡œ í‘œì¶œí•˜ëŠ” ì‹œê¸°ë¡œ, ìƒˆë¡œìš´ ì‚¬ì—…ì„ ì‹œì‘í•˜ê±°ë‚˜ í”„ë¦¬ëœì„œ, ì „ë¬¸ ê¸°ìˆ ì§ì—ì„œ ë‘ê°ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.`);
                    else if(tenGod === "ì¸ì„±") lines.push(`ë¬¸ì„œ(ë¶€ë™ì‚°) ì·¨ë“ì´ë‚˜ ìê²©ì¦, í•™ìœ„ ì·¨ë“ ë“± ì§€ì  ìì‚°ì„ í†µí•´ ì•ˆì •ì ì¸ ê¸°ë°˜ì„ ë§ˆë ¨í•˜ëŠ” ì‹œê¸°ì…ë‹ˆë‹¤.`);
                    else lines.push(`ì‚¬ëŒë“¤ê³¼ì˜ í˜‘ì—…ì´ë‚˜ ì¹˜ì—´í•œ ê²½ìŸì„ í†µí•´ ë³¸ì¸ì˜ ì…ì§€ë¥¼ ë‹¤ì§€ë©°, ì¸ë§¥ì´ ê³§ ìì‚°ì´ ë˜ëŠ” ì‹œê¸°ì…ë‹ˆë‹¤.`);

                    if(dwEle === lackEle) lines.push(`ê¸°ë‹¤ë¦¬ë˜ ë•Œê°€ ì™”ìŠµë‹ˆë‹¤. ë¬¼ ë“¤ì–´ì˜¬ ë•Œ ë…¸ ì “ë“¯ì´ ì ê·¹ì ìœ¼ë¡œ í™œë™í•˜ë©´ í° ì‚¬íšŒì  ì„±ì·¨ë¥¼ ì´ë£° ìˆ˜ ìˆìŠµë‹ˆë‹¤.`);
                    else lines.push(`ë¬´ë¦¬í•œ í™•ì¥ë³´ë‹¤ëŠ” í˜„ì¬ì˜ ìœ„ì¹˜ë¥¼ ì§€í‚¤ëŠ” ê²ƒì´ ìœ ë¦¬í•˜ë©°, ë‹¤ìŒ ê¸°íšŒë¥¼ ìœ„í•´ ë‚´ì‹¤ì„ ë‹¤ì ¸ì•¼ í•©ë‹ˆë‹¤.`);

                } else if (period === 'late') {
                    // [ë§ë…„ê¸°]
                    lines.push(`ë§ë…„ì—ëŠ” '${tenGod}'ì˜ ê¸°ìš´ì´ ë“¤ì–´ì™€ ì‚¶ì„ ë§ˆë¬´ë¦¬í•©ë‹ˆë‹¤.`);
                    if(tenGod === "ì‹ìƒ") lines.push(`ë‚˜ì´ê°€ ë“¤ì–´ì„œë„ ì·¨ë¯¸ ìƒí™œì´ë‚˜ ì†Œì¼ê±°ë¦¬ë¥¼ ì¦ê¸°ë©°, í™œë ¥ ë„˜ì¹˜ê³  ì Šê²Œ ì‚¬ëŠ” ë…¸í›„ë¥¼ ë³´ëƒ…ë‹ˆë‹¤.`);
                    else if(tenGod === "ì¬ì„±") lines.push(`ê²½ì œì  ì—¬ìœ ê°€ ìˆì–´ ì‚¶ì„ ì¦ê¸°ê³ , ìë…€ë“¤ì—ê²Œ ì† ë²Œë¦¬ì§€ ì•ŠëŠ” í’ìš”ë¡œìš´ ë§ë…„ì…ë‹ˆë‹¤.`);
                    else if(tenGod === "ê´€ì„±") lines.push(`ìë…€ì˜ ì„±ê³µìœ¼ë¡œ ë•ì„ ë³´ê±°ë‚˜, ì§€ì—­ ì‚¬íšŒì—ì„œ ì–´ë¥¸ìœ¼ë¡œì„œ ì¡´ê²½ë°›ìœ¼ë©° ëª…ì˜ˆë¥¼ ì§€í‚µë‹ˆë‹¤.`);
                    else if(tenGod === "ì¸ì„±") lines.push(`ì •ì‹ ì ì¸ ì•ˆì •ì„ ì¶”êµ¬í•˜ë©° ì¢…êµë‚˜ ëª…ìƒ, ë…ì„œ ë“±ì„ í†µí•´ ë‚´ë©´ì˜ í‰í™”ë¥¼ ì°¾ëŠ” ì‹œê¸°ì…ë‹ˆë‹¤.`);
                    else lines.push(`ì¹œêµ¬, ë°°ìš°ìì™€ ì˜ì§€í•˜ë©° ë“±ì‚°ì´ë‚˜ ëª¨ì„ì„ ê°–ëŠ” ë“± ì™¸ë¡­ì§€ ì•Šê²Œ ì–´ìš¸ë ¤ ì§€ë‚´ëŠ” ë…¸í›„ì…ë‹ˆë‹¤.`);

                    if(dwEle === lackEle) lines.push(`í‰ìƒì˜ ë…¸ë ¥ì´ ë³´ìƒë°›ë“¯ ê±´ê°•í•˜ê³  í¸ì•ˆí•œ ë§ë…„ì„ ë³´ë‚´ê²Œ ë˜ë©°, ìì†ë“¤ë„ ë²ˆì°½í•©ë‹ˆë‹¤.`);
                    else lines.push(`ê±´ê°• ê´€ë¦¬ì— ê°ë³„íˆ ì‹ ê²½ ì¨ì•¼ í•˜ë©°, ì¬ë¬¼ ìš•ì‹¬ì„ ë²„ë¦¬ê³  ë§ˆìŒì„ ë¹„ìš¸ ë•Œ í‰ì•ˆì´ ì°¾ì•„ì˜µë‹ˆë‹¤.`);
                }
                return lines.join('\n');
            };

            const uniqueIdx = (myGan.charCodeAt(0) + y + m + d) % 9;
            const luckyColor = ["ê³¨ë“œ", "ì œì´ë“œ ê·¸ë¦°", "ë¸”ë™", "ë¸Œë¼ìš´", "ì‹¤ë²„", "ì™€ì¸", "íˆ¬ëª…", "ì²­ììƒ‰", "ìš°ë“œ"][uniqueIdx];
            const luckyItem = ["í™©ê¸ˆ ì—´ì‡ ", "ì˜¥ë°˜ì§€", "ë§Œë…„í•„", "ê°€ì£½ ì§€ê°‘", "ì€ìˆ˜ì €", "ë¹„ë‹¨ ìŠ¤ì¹´í”„", "í¬ë¦¬ìŠ¤íƒˆ", "ë„ìê¸°", "ë‚˜ë¬´ ì—¼ì£¼"][uniqueIdx];

            document.getElementById('summaryArea').innerHTML = `
                <div class="info-card"><span class="info-label">í‰ìƒ ìš´ì„¸ ì´ì </span><span class="info-value">${totalScore}ì </span></div>
                <div class="info-card"><span class="info-label">íƒ€ê³ ë‚œ ì¼ê°„(ë³¸ì›)</span><span class="info-value">${myGan} (ë‚˜)</span></div>
                <div class="info-card"><span class="info-label">ìˆ˜í˜¸ ì»¬ëŸ¬</span><span class="info-value">${luckyColor}</span></div>
                <div class="info-card"><span class="info-label">í‰ìƒ í–‰ìš´í…œ</span><span class="info-value">${luckyItem}</span></div>
            `;

            document.getElementById('resTotal').innerText = buildDynamicText('total');
            document.getElementById('resEarly').innerText = buildDynamicText('early');
            document.getElementById('resMiddle').innerText = buildDynamicText('middle');
            document.getElementById('resLate').innerText = buildDynamicText('late');

            // [ê·¸ë˜í”„]
            const chart=document.getElementById('chartArea'); chart.innerHTML = '';
            const ageLabels = ["10ëŒ€", "20ëŒ€", "30ëŒ€", "40ëŒ€", "50ëŒ€", "60ëŒ€", "70ëŒ€", "80ëŒ€"];
            
            for(let i=0; i<8; i++) {
                let ganZhi = manualDaewoon[i].label;
                let wave = Math.sin((i + uniqueIdx) * 0.9) * 30;
                let score = Math.floor(60 + wave + (i % 3 * 5));
                score = Math.min(98, Math.max(30, score));

                let w = document.createElement('div'); w.className='bar-wrapper';
                w.innerHTML = `
                    <span class="score-val" style="bottom:${score}%">${score}</span>
                    <div class="bar" style="height:${score}%"></div>
                    <span class="graph-label">${ageLabels[i]}<br>(${ganZhi})</span>
                `;
                chart.appendChild(w);
            }

            document.getElementById('result-area').style.display = 'block';
            window.scrollTo({ top: document.getElementById('result-area').offsetTop - 100, behavior: 'smooth' });
        }
    </script>
</body>
</html>